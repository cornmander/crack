# Binding for builder/util.md5.h
# (C) Conrad Steenberg <conrad.steenberg@gmail.com>
# 6/22/2012


@import crack.extgen generateExtension;

@generateExtension crack.runtime.md5 {
    @filename 'runtime/MD5.cc'
    @dumpsymbols 'opt/md5.txt'
    @inject '// (C) Conrad Steenberg <conrad.steenberg@gmail.com> under LGPLv2\n// 6/22/2012\n'
    @inject '#include "builder/util/md5.h"\n'
    @crack_internal


    @inject 'md5_state_s *crk_new_md5_state(){
               md5_state_s *state = new md5_state_s;
               md5_init(state);
               return state;
            }\n'

    @cname md5_state_s
    class md5;

    @cname crk_new_md5_state
    md5 md5_init();

    // Append a string to the message
    void md5_append(md5 state, byteptr data, int nbytes);

    // Finish the message and return the digest.
    @cname md5_finish
    void md5_finish(md5 state, byteptr digest);

}
